CREATE TABLE IF NOT EXISTS  core.pas_vertschl (pas_vertschl_sid  STRING COMMENT 'Surrgate Key', pas_vertschl_id  STRING COMMENT 'Foreign Key', pas_vt_id  STRING COMMENT 'Foreign Key', bearbid  INTEGER COMMENT 'the historical version number (logId)', bearbidabg  INTEGER COMMENT 'the historical version that invalidates this version (nextLogId)', lvid  STRING COMMENT 'id of Lv (Das Field lvId identifiziert denVertrag, zu dem diese Row gehoert.)', vtid  SMALLINT COMMENT 'id of Vt (generically derived from Vt)', fondsid  INTEGER COMMENT 'id of Vertschl (Interne Kennummer eines Fonds)', pant  DECIMAL(16,8) COMMENT 'Proz. Anteil zu dem der Sparbeitrag in einen Fonds fliesst.Constraint pant_RANGE: die proz', naturp  INTEGER COMMENT 'Kennzeichen ob Naturalleistung zugelassen ist.', datleaus  TIMESTAMP COMMENT 'Datum der letzten Fondsausschuettung.', datlerueck  TIMESTAMP COMMENT 'Datum der letzten Rueckerstattung KoeSt.', datleumst  TIMESTAMP COMMENT 'Datum der letzten Fondsumstellung.', nateant  DECIMAL(22,8) COMMENT 'Anzahl der ueber Naturaleinlage eingebrachten Fondsanteile', datleausfp  TIMESTAMP COMMENT 'Datum der letzten Fondsausschuettung Forward Pricing (Schritt 2)', datumsch  TIMESTAMP COMMENT 'Datum der Umschichtung/Fondsliquidation', kzwertsicher  INTEGER COMMENT 'id of Vertschl (Verwendungscharakter des Fonds im Vertrag (auch ein Garantiefonds kann als', partkey  SMALLINT COMMENT 'the partition key', kursselektion  INTEGER COMMENT 'Gibt vor , welche Kursarten zu selektieren sind. (Contains constants for the types of fund', kzabwfondswifri  INTEGER COMMENT 'Kennzeichen fuer abweichenden Fonds in der Widerrufsfrist', investtype  INTEGER COMMENT 'id of Vertschl (Bestimmt fuer welche Investition (Beitrag, Zuzahlung) der Verteilungsschlu', portfid  INTEGER COMMENT 'id of Vertschl (Interne Kennnummer eines Portfolios)', fondsstatus  INTEGER COMMENT 'Kennzeichnung ob der Fonds fuer Anlage offen ist.', pantinportf  DECIMAL(16,8) COMMENT 'relativer Anteil eines Fonds unterhalb eines Portfolios bzw. 100, falls der Fonds nicht zu', pantofportf  DECIMAL(16,8) COMMENT 'relativer Anteil eines Portfolios im vertschl bzw. gleich dem pant, falls der Fonds nicht ', kzgemanagt  INTEGER COMMENT 'Kennzeichen gemanagtes Portfolio', portfname  STRING COMMENT 'Name des Portfolios', datlebstdswitch  TIMESTAMP COMMENT 'Datum letzter Bestandsswitch', tpa_mandant STRING, wirksam_ab TIMESTAMP, gueltig_ab TIMESTAMP, diff_hash  STRING COMMENT 'Hash for comparing records for inserts.', record_hash  STRING COMMENT 'Hash for all non technical attributes.', insert_tst  TIMESTAMP COMMENT 'Timestamp for creation of record.', source_system  INTEGER COMMENT 'Name of source system.', primary key(lvid, fondsid, kzwertsicher, portfid) disable novalidate ) COMMENT 'Prozentuale Verteilung der Zahlungsstroeme auf die FondsHistorie-streng: Attribute, die zur strengen Historienfuehrung am Vertrag benoetigt werdenVerteilungsschluessel: Angaben zur prozentualen Verteilung auf die Fonds' PARTITIONED BY (process_id  INTEGER COMMENT 'Unique id for ETL-Processes.')  STORED AS parquet TBLPROPERTIES ('PARQUET.COMPRESS'='SNAPPY');